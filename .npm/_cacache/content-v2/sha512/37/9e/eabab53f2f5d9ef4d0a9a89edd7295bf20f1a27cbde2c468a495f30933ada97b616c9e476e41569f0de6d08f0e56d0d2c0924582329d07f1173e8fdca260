{"_id":"json-schema-ref-resolver","_rev":"5-3ca32521ede153b94ccde6d1818eb7bf","name":"json-schema-ref-resolver","dist-tags":{"latest":"1.0.1"},"versions":{"1.0.0":{"name":"json-schema-ref-resolver","version":"1.0.0","keywords":["json","schema","reference","openapi","swagger"],"author":{"name":"Ivan Tymoshenko","email":"ivan@tymoshenko.me"},"license":"MIT","_id":"json-schema-ref-resolver@1.0.0","maintainers":[{"name":"ivan-tymoshenko","email":"ivan@tymoshenko.me"}],"homepage":"https://github.com/fastify/json-schema-ref-resolver#readme","bugs":{"url":"https://github.com/fastify/json-schema-ref-resolver/issues"},"dist":{"shasum":"9658b72f2f392f8918bf4f02ce473e110411a2e2","tarball":"https://registry.npmjs.org/json-schema-ref-resolver/-/json-schema-ref-resolver-1.0.0.tgz","fileCount":16,"integrity":"sha512-Zk8xct86amJprq2xjVmCcnlJF/wCrah/LAUNDalCuXQSsTcLUulR4IZh4qjydxhgLFRFqdabfaY19otbZfrm/g==","signatures":[{"sig":"MEUCIQCa4ZyBXKbm1cHvEEwUNZCrPqBh84W+1XgnGWgBmxlV4AIgY2C1Ym/kl2/XsCg56myuCuchDBdA1I9NtdJaigwg3sM=","keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA"}],"unpackedSize":54514},"main":"index.js","types":"types/index.d.ts","gitHead":"2f10f646621ef565dc397cc0b697eebc1be27bef","scripts":{"lint":"standard","test":"npm run lint && npm run test:unit && npm run test:typescript","lint:fix":"standard --fix","test:unit":"c8 --100 node --test","test:typescript":"tsd"},"_npmUser":{"name":"ivan-tymoshenko","email":"ivan@tymoshenko.me"},"standard":{"ignore":["types/*"]},"precommit":["lint","test"],"repository":{"url":"git+https://github.com/fastify/json-schema-ref-resolver.git","type":"git"},"_npmVersion":"9.8.1","description":"JSON schema reference resolver","directories":{},"_nodeVersion":"18.18.0","dependencies":{"fast-deep-equal":"^3.1.3"},"_hasShrinkwrap":false,"devDependencies":{"c8":"^8.0.1","tsd":"^0.29.0","standard":"^17.1.0"},"_npmOperationalInternal":{"tmp":"tmp/json-schema-ref-resolver_1.0.0_1697835447758_0.8245553781407775","host":"s3://npm-registry-packages"}},"1.0.1":{"name":"json-schema-ref-resolver","version":"1.0.1","keywords":["json","schema","reference","openapi","swagger"],"author":{"name":"Ivan Tymoshenko","email":"ivan@tymoshenko.me"},"license":"MIT","_id":"json-schema-ref-resolver@1.0.1","maintainers":[{"name":"ivan-tymoshenko","email":"ivan@tymoshenko.me"}],"homepage":"https://github.com/fastify/json-schema-ref-resolver#readme","bugs":{"url":"https://github.com/fastify/json-schema-ref-resolver/issues"},"dist":{"shasum":"6586f483b76254784fc1d2120f717bdc9f0a99bf","tarball":"https://registry.npmjs.org/json-schema-ref-resolver/-/json-schema-ref-resolver-1.0.1.tgz","fileCount":16,"integrity":"sha512-EJAj1pgHc1hxF6vo2Z3s69fMjO1INq6eGHXZ8Z6wCQeldCuwxGK9Sxf4/cScGn3FZubCVUehfWtcDM/PLteCQw==","signatures":[{"sig":"MEUCIQDfBY6TdvwtrZDpu+btjN66Y71WMBetN1MMww40G+NfdwIgPjbKpcRFxpMCOEWCS6Rv6Jn8EvyU2vajOIrc5bin5HU=","keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA"}],"unpackedSize":55958},"main":"index.js","types":"types/index.d.ts","gitHead":"ff4293ac39216332f27a6266b1b04a97e2e14805","scripts":{"lint":"standard","test":"npm run lint && npm run test:unit && npm run test:typescript","lint:fix":"standard --fix","test:unit":"c8 --100 node --test","test:typescript":"tsd"},"_npmUser":{"name":"ivan-tymoshenko","email":"ivan@tymoshenko.me"},"standard":{"ignore":["types/*"]},"precommit":["lint","test"],"repository":{"url":"git+https://github.com/fastify/json-schema-ref-resolver.git","type":"git"},"_npmVersion":"9.8.1","description":"JSON schema reference resolver","directories":{},"_nodeVersion":"18.18.0","dependencies":{"fast-deep-equal":"^3.1.3"},"_hasShrinkwrap":false,"devDependencies":{"c8":"^8.0.1","tsd":"^0.29.0","standard":"^17.1.0"},"_npmOperationalInternal":{"tmp":"tmp/json-schema-ref-resolver_1.0.1_1697964711137_0.5876407776532409","host":"s3://npm-registry-packages"}}},"time":{"created":"2023-10-20T20:57:27.617Z","modified":"2024-07-10T19:05:58.199Z","1.0.0":"2023-10-20T20:57:28.005Z","1.0.1":"2023-10-22T08:51:51.366Z"},"bugs":{"url":"https://github.com/fastify/json-schema-ref-resolver/issues"},"author":{"name":"Ivan Tymoshenko","email":"ivan@tymoshenko.me"},"license":"MIT","homepage":"https://github.com/fastify/json-schema-ref-resolver#readme","keywords":["json","schema","reference","openapi","swagger"],"repository":{"url":"git+https://github.com/fastify/json-schema-ref-resolver.git","type":"git"},"description":"JSON schema reference resolver","maintainers":[{"email":"james.sumners@gmail.com","name":"jsumners"},{"email":"kaka@kakawebsitedemo.com","name":"climba03003"},{"email":"hey@gurgun.day","name":"gurgunday"},{"email":"simone.busoli@gmail.com","name":"simoneb"},{"email":"ivan@tymoshenko.me","name":"ivan-tymoshenko"},{"email":"behemoth89@gmail.com","name":"eomm"},{"email":"vince.legoff@gmail.com","name":"zekth"},{"email":"rafael.nunu@hotmail.com","name":"rafaelgss"},{"email":"hello@matteocollina.com","name":"matteo.collina"}],"readme":"# json-schema-ref-resolver\n\n__json-schema-ref-resolver__ is a javascript library that resolves references in [JSON schemas](https://json-schema.org/draft/2020-12/json-schema-core#name-introduction).\n\n- [Installation](#installation)\n- [Usage](#usage)\n- [API](#api)\n  - [RefResolver([options])](#refresolveroptions)\n  - [addSchema(schema, [schemaId])](#addschemaschema-schemaid)\n  - [getSchema(schemaId, [jsonPointer])](#getschemaschemaid-jsonpointer)\n  - [getSchemaRefs(schemaId)](#getschemarefsschemaid)\n  - [getSchemaDependencies(schemaId)](#getschemadependenciesschemaid)\n  - [derefSchema(schemaId)](#derefschemaschemaid)\n  - [getDerefSchema(schemaId, [jsonPointer])](#getderefschemaschemaid-jsonpointer)\n- [Caveats](#caveats)\n\n<a name=\"installation\"></a>\n\n## Installation\n\n```bash\nnpm install json-schema-ref-resolver\n```\n\n<a name=\"usage\"></a>\n\n## Usage\n\n```javascript\nconst assert = require('node:assert')\nconst { RefResolver } = require('json-schema-ref-resolver')\n\nconst sourceSchema = {\n  $id: 'sourceSchema',\n  type: 'object',\n  properties: {\n    foo: {\n      $ref: 'targetSchema#/definitions/bar'\n    }\n  }\n}\n\nconst targetSchema = {\n  $id: 'targetSchema',\n  definitions: {\n    bar: {\n      type: 'string'\n    }\n  }\n}\n\nconst refResolver = new RefResolver()\n\nrefResolver.addSchema(sourceSchema)\nrefResolver.addSchema(targetSchema)\n\nconst derefSourceSchema = refResolver.getDerefSchema('sourceSchema')\nassert.deepStrictEqual(derefSourceSchema, {\n  $id: 'sourceSchema',\n  type: 'object',\n  properties: {\n    foo: {\n      type: 'string'\n    }\n  }\n})\n```\n\n<a name=\"api\"></a>\n\n## API\n\n<a name=\"constructor\"></a>\n\n#### RefResolver([options])\n\n- __allowEqualDuplicates__ - if set to `false`, an error will be thrown if a schema with the same `$id` is added to the resolver. If set to `true`, the error will be thrown only if the schemas are not equal. Default: `true`.\n\n- __insertRefSymbol__ - if set to `true` resolver inserts a `Symbol.for('json-schema-ref')` instead of the `$ref` property when dereferencing a schema. Default `false`.\n\n- __cloneSchemaWithoutRefs__ - if set to `false` resolver would not clone a schema if it does not have references. That allows to significantly improve performance when dereferencing a schema. If you want to modify a schema after dereferencing, set this option to `true`. Default: `false`.\n\n<a name=\"add-schema\"></a>\n\n#### addSchema(schema, [schemaId])\n\nAdds a json schema to the resolver. If the schema has an `$id` property, it will be used as the schema id. Otherwise, the `schemaId` argument will be used as the schema id. During the addition of the schema, ref resolver will find and add all nested schemas and references.\n\n- `schema` __\\<object\\>__ - json schema to add to the resolver.\n- `schemaId` __\\<string\\>__ - schema id to use. Will be used only if the schema does not have an `$id` property.\n\n<a name=\"get-schema\"></a>\n\n#### getSchema(schemaId, [jsonPointer])\n\nReturns a json schema by its id. If the `jsonPointer` argument is provided, ref resolver will return the schema at the specified json pointer location.\n\nIf shema with the specified id is not found, an error will be thrown. If the `jsonPointer` argument is provided and the schema at the specified location is not found, getSchema will return `null`.\n\n- `schemaId` __\\<string\\>__ - schema id of the schema to return.\n- `jsonPointer` __\\<string\\>__ - json pointer to the schema location.\n- __Returns__ - json schema or `null` if the schema at the specified location is not found.\n\n_Example:_\n\n```javascript\nconst assert = require('node:assert')\nconst { RefResolver } = require('json-schema-ref-resolver')\n\nconst schema = {\n  $id: 'schema',\n  type: 'object',\n  properties: {\n    foo: { type: 'string' }\n  }\n}\n\nconst refResolver = new RefResolver()\nrefResolver.addSchema(schema)\n\nconst rootSchema = refResolver.getSchema(schema.$id)\nassert.deepStrictEqual(rootSchema, schema)\n\nconst subSchema = refResolver.getSchema(schema.$id, '#/properties/foo')\nassert.deepStrictEqual(subSchema, { type: 'string' })\n```\n\n`getSchema` can also be used to get a schema by its [json schema anchor](https://json-schema.org/draft/2020-12/json-schema-core#section-8.2.2). To get schema by schema anchor, the `schemaId` argument must be set to the `$id` of the schema that contains the anchor, and the `jsonPointer` argument must be set to the anchor.\n\n_Example:_\n\n```javascript\nconst assert = require('node:assert')\nconst { RefResolver } = require('json-schema-ref-resolver')\n\nconst schema = {\n  $id: 'schema',\n  definitions: {\n    bar: {\n      $id: '#bar',\n      type: 'string'\n    }\n  }\n}\n\nconst refResolver = new RefResolver()\nrefResolver.addSchema(schema)\n\nconst anchorSchema = refResolver.getSchema(schema.$id, '#bar')\nassert.deepStrictEqual(subSchema, {\n  $id: '#bar',\n  type: 'string'\n})\n```\n\n<a name=\"get-schema-refs\"></a>\n\n#### getSchemaRefs(schemaId)\n\nReturns all references found in the schema during the addition of the schema to the resolver. If schema with the specified id is not found, an error will be thrown.\n\n- `schemaId` __\\<string\\>__ - schema id of the schema to return references for.\n- __Returns__ - array of objects with the following properties:\n  - `schemaId` __\\<string\\>__ - schema id of the reference.\n  - `jsonPointer` __\\<string\\>__ - json pointer of the reference.\n\nIf a reference does not have a schema id part, the schema id of the schema that contains the reference is used as the schema id of the reference.\n\n_Example:_\n\n```javascript\nconst assert = require('node:assert')\n\nconst { RefResolver } = require('json-schema-ref-resolver')\n\nconst sourceSchema = {\n  $id: 'sourceSchema',\n  type: 'object',\n  properties: {\n    foo: {\n      $ref: 'targetSchema#/definitions/bar'\n    },\n    baz: {\n      $ref: 'targetSchema#/definitions/qux'\n    }\n  }\n}\n\nconst refResolver = new RefResolver()\nrefResolver.addSchema(sourceSchema)\n\nconst refs = refResolver.getSchemaRefs('sourceSchema')\nassert.deepStrictEqual(refs, [\n  {\n    schemaId: 'targetSchema',\n    jsonPointer: '#/definitions/bar'\n  },\n  {\n    schemaId: 'targetSchema',\n    jsonPointer: '#/definitions/qux'\n  }\n])\n```\n\n<a name=\"get-schema-dependencies\"></a>\n\n#### getSchemaDependencies(schemaId)\n\nReturns all dependencies including nested dependencies found in the schema during the addition of the schema to the resolver. If schema with the specified id is not found, an error will be thrown.\n\n- `schemaId` __\\<string\\>__ - schema id of the schema to return dependencies for.\n- __Returns__ - an object with all found dependencies. The object keys are schema ids and the values are schema dependencies.\n\n_Example:_\n\n```javascript\nconst assert = require('node:assert')\n\nconst { RefResolver } = require('json-schema-ref-resolver')\n\nconst targetSchema1 = {\n  $id: 'targetSchema1',\n  definitions: {\n    bar: { type: 'string' }\n  }\n}\n\nconst targetSchema2 = {\n  $id: 'targetSchema2',\n  type: 'object',\n  properties: {\n    qux: { $ref: 'targetSchema1' }\n  }\n}\n\nconst sourceSchema = {\n  $id: 'sourceSchema',\n  type: 'object',\n  properties: {\n    foo: { $ref: 'targetSchema2' }\n  }\n}\n\nconst refResolver = new RefResolver()\n\nrefResolver.addSchema(sourceSchema)\nrefResolver.addSchema(targetSchema1)\nrefResolver.addSchema(targetSchema2)\n\nconst dependencies = refResolver.getSchemaDependencies('sourceSchema')\nassert.deepStrictEqual(dependencies, { targetSchema1, targetSchema2 })\n```\n\n<a name=\"deref-schema\"></a>\n\n#### derefSchema(schemaId)\n\nDereferences all references in the schema. All dependency also will be dereferenced. If schema with the specified id is not found, an error will be thrown.\n\n- `schemaId` __\\<string\\>__ - schema id of the schema to dereference.\n\n__If a json schema has circular references or circular cross-references, dereferenced schema will have js circular references. Be careful when traversing the dereferenced schema.__\n\n_Example_\n\n```javascript\nconst assert = require('node:assert')\nconst { RefResolver } = require('json-schema-ref-resolver')\n\nconst sourceSchema = {\n  $id: 'sourceSchema',\n  type: 'object',\n  properties: {\n    foo: {\n      $ref: 'targetSchema#/definitions/bar'\n    }\n  }\n}\n\nconst targetSchema = {\n  $id: 'targetSchema',\n  definitions: {\n    bar: {\n      type: 'string'\n    }\n  }\n}\n\nconst refResolver = new RefResolver()\n\nrefResolver.addSchema(sourceSchema)\nrefResolver.addSchema(targetSchema)\n\nrefResolver.derefSchema('sourceSchema')\nconst derefSourceSchema = refResolver.getDerefSchema('sourceSchema')\n\nassert.deepStrictEqual(derefSourceSchema, {\n  $id: 'sourceSchema',\n  type: 'object',\n  properties: {\n    foo: {\n      type: 'string'\n    }\n  }\n})\n```\n\n<a name=\"get-deref-schema\"></a>\n\n#### getDerefSchema(schemaId, [jsonPointer])\n\nReturns a dereferenced schema by schema id and json pointer. If schema with the specified id is not found, an error will be thrown. If the `jsonPointer` argument is provided, ref resolver will return the schema at the specified json pointer location. If the `jsonPointer` argument is provided and the schema at the specified location is not found, getDerefSchema will return `null`.\n\nIf schema was not dereferenced before, it will be dereferenced during the call to `getDerefSchema`.\n\n- `schemaId` __\\<string\\>__ - schema id of the schema to return.\n- `jsonPointer` __\\<string\\>__ - json pointer to the schema location.\n- __Returns__ - dereferenced json schema or `null` if the schema at the specified location is not found.\n\n_Example:_\n\n```javascript\nconst assert = require('node:assert')\nconst { RefResolver } = require('json-schema-ref-resolver')\n\nconst sourceSchema = {\n  $id: 'sourceSchema',\n  type: 'object',\n  properties: {\n    foo: {\n      $ref: 'targetSchema#/definitions/bar'\n    }\n  }\n}\n\nconst targetSchema = {\n  $id: 'targetSchema',\n  definitions: {\n    bar: {\n      type: 'string'\n    }\n  }\n}\n\nconst refResolver = new RefResolver()\n\nrefResolver.addSchema(sourceSchema)\nrefResolver.addSchema(targetSchema)\n\nconst derefSourceSchema = refResolver.getDerefSchema('sourceSchema')\nassert.deepStrictEqual(derefSourceSchema, {\n  $id: 'sourceSchema',\n  type: 'object',\n  properties: {\n    foo: {\n      type: 'string'\n    }\n  }\n})\n```\n\n#### Caveats\n\n- If a reference schema and a source schema have a key with the same name and different values, an error will be throwing during a call to `derefSchema` or `getDerefSchema`.\n\n_Example:_\n\n```javascript\nconst assert = require('node:assert')\nconst { RefResolver } = require('json-schema-ref-resolver')\n\nconst targetSchema = {\n  $id: 'targetSchema',\n  definitions: {\n    bar: {\n      type: 'object',\n      properties: {\n        foo: { type: 'string' }\n      }\n    }\n  }\n}\n\nconst sourceSchema = {\n  $id: 'sourceSchema',\n  type: 'object',\n  $ref: 'targetSchema#/definitions/bar'\n  properties: {\n    foo: { type: 'number' }\n  }\n}\n\nconst refResolver = new RefResolver()\nrefResolver.addSchema(targetSchema)\nrefResolver.addSchema(sourceSchema)\n\nrefResolver.derefSchema('sourceSchema') // Throws an error\n```\n","readmeFilename":"README.md"}